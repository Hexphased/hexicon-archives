<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow">
    <title>RomCom - Hexicon Archives</title>
    <link rel="icon" type="image/x-icon" sizes="500x500" href="../favicon.png">
    <link rel="stylesheet" href="../style.css">
    <link rel="canonical" href="https://hexphased.github.io/hexicon-archives/sherlocks/RomCom.html" />
    <!-- Sherlock-specific metadata for SEO -->
    <meta name="description" content="Writeup for RomCom sherlock - VEasy difficulty level">
    <meta name="keywords" content="Sherlock, RomCom, VEasy, Blue Team, writeup, cybersecurity, threat hunting, Hexicon">
</head>
<body>
    <header>
        <div class="container header-content">
            <a href="../sherlocks.html" class="logo">Sherlock writeups</a>
            <div class="header-controls">
                <a href="../index.html" class="htb-icon" title="Link to the main page">
                    <img src="../favicon.png" alt="Archive" width="30" height="30">
                </a>
                <div class="hamburger-menu">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
        </div>
    </header>
    
    <div class="sidebar">
        <div class="difficulty-buttons">
            <button class="difficulty-btn" data-difficulty="veasy">VEasy</button>
            <div class="sherlock-list" id="veasy-sherlocks">
                <!-- Will be populated dynamically -->
            </div>

            <button class="difficulty-btn" data-difficulty="easy">Easy</button>
            <div class="sherlock-list" id="easy-sherlocks">
                <!-- Will be populated dynamically -->
            </div>
            
            <button class="difficulty-btn" data-difficulty="medium">Medium</button>
            <div class="sherlock-list" id="medium-sherlocks">
                <!-- Will be populated dynamically -->
            </div>
            
            <button class="difficulty-btn" data-difficulty="hard">Hard</button>
            <div class="sherlock-list" id="hard-sherlocks">
                <!-- Will be populated dynamically -->
            </div>

            <button class="difficulty-btn" data-difficulty="insane">Insane</button>
            <div class="sherlock-list" id="insane-sherlocks">
                <!-- Will be populated dynamically -->
            </div>
        </div>
    </div>
    
    <div class="backdrop"></div>
    
    <main class="container writeup-content">
        <h1 class="writeup-title">RomCom</h1>
        <div class="writeup-metadata">
            <span class="difficulty veasy">VEasy</span>
            <span class="date">September 11, 2025</span>
        </div>
        
        <div class="writeup-container">
            <div class="writeup-body">
                <!-- Sherlock-specific content goes here -->
                <p><img alt="solved" src="../images/RomCom/solved.png" /></p>
<h1>Task 1</h1>
<p>I can get an answer to this question without unzipping the archive. I'll search the web using 3 keywords from the question.</p>
<p><code>2025 RomCom WinRAR</code></p>
<p>This led me to an article describing <code>CVE-2025-8088</code>, a path traversal in WinRAR versions below 7.13.</p>
<p><code>https://www.secpod.com/blog/winrar-cve-2025-8088-romcoms-doorway-to-remote-code-execution/</code></p>
<p><img alt="article" src="../images/RomCom/article.png" /></p>
<p>The CVE number will be my answer to question 1.</p>
<p><img alt="task1" src="../images/RomCom/task1.png" /></p>
<h1>Task 2</h1>
<p>The answer to this question was already brought up while solving question 1, and it is <code>path traversal</code></p>
<p><img alt="task2" src="../images/RomCom/task2.png" /></p>
<h1>Task 3</h1>
<p>Inside the challenge archive, there was a .vhdx disk image file. Since I am using a Windows machine, I can mount it by right-clicking and choosing <code>mount</code></p>
<p><img alt="image" src="../images/RomCom/image.png" /></p>
<p>In the C directory, there is an $MFT file, and in the $Extend directory inside, there is the $J journal(UsnJournal).</p>
<p>With these two, files I can get a pretty thorough history of which files, where, and when they were created on the system.</p>
<p>I will use MFTECmd.exe to parse the journals.</p>
<p><code>MFTECmd.exe -f "E:\C\$Extend\$J" -m "E:\C\$MFT" --csv C:\Users\malware\Desktop\challs\RomCom\out</code></p>
<p><img alt="mfte" src="../images/RomCom/mfte.png" /></p>
<p>This dropped two files in the out directory. I opened the $MFT output and searched for <code>.rar</code> archives.</p>
<p><img alt="rar" src="../images/RomCom/rar.png" /></p>
<p>The name of this malicious archive is <code>Pathology-Department-Research-Records.rar</code></p>
<p><img alt="task3" src="../images/RomCom/task3.png" /></p>
<h1>Task 4</h1>
<p>I'll open the $J output file. This is where timestamps related to file creation, modification, and more are present.</p>
<p>I used the archive's name to search through the $J entries.</p>
<p><img alt="j" src="../images/RomCom/j.png" /></p>
<p>The first highlighted entry is a <code>FileCreate</code> event tied to the archive, which occurred at <code>2025-09-02 08:13:50</code></p>
<p>This timestamp will be my answer to task 4.</p>
<p><img alt="task4" src="../images/RomCom/task4.png" /></p>
<h1>Task 5</h1>
<p>When a file is opened for the first time, Windows will create a .lnk shortcut file. This creation is captured in the UsnJournal as well.</p>
<p>Scrolling down, I quickly found the .lnk file related to the malicious archive.</p>
<p><img alt="filecreate" src="../images/RomCom/filecreate.png" /></p>
<p>This happened at <code>2025-09-02 08:14:04</code>, and this timestamp will be my answer to question 5.</p>
<p><img alt="task5" src="../images/RomCom/task5.png" /></p>
<h1>Task 6</h1>
<p>I took the path of the malicious archive and searched for any recently created files in the same directory.</p>
<p><img alt="files" src="../images/RomCom/files.png" /></p>
<p>There are 3 files in total. Since they have the same creation timestamp, they came from the same extract action.</p>
<p>The decoy document is most definitely <code>Genotyping_Results_B57_Positive.pdf</code>, and it will be my answer to question 6.</p>
<p><img alt="task6" src="../images/RomCom/task6.png" /></p>
<h1>Task 7</h1>
<p>There was an executable listed in the $J output. It is the ApbxHelpex.exe file located under <code>C:\Users\susan\AppData\Local</code></p>
<p>Since these 3 files have the exact same creation time, it means that they were extracted from the same archive. The fact that they are in different directories means that the path traversal exploit aws used successfully.</p>
<p>The full filepath will be <code>C:\Users\susan\AppData\Local\ApbxHelper.exe</code>, and it will be my answer to question 7.</p>
<p><img alt="task7" src="../images/RomCom/task7.png" /></p>
<h1>Task 8</h1>
<p>Second, and the last file extracted with the path traversal exploit is the <code>Display Settings.lnk</code> file.</p>
<p>The location where it was extracted is used to hold programs that will be executed when the user logs in. Most likely, the shortcut is pointing to the ApbxHelper.exe file.</p>
<p><code>C:\Users\Susan\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\Display Settings.lnk</code> will be my answer to question 8.</p>
<p><img alt="task8" src="../images/RomCom/task8.png" /></p>
<h1>Task 9</h1>
<p>I am looking for a Mitre technique associated with placing scripts/programs in the startup directory, so that they will be executed whenever the user logs in.</p>
<p>This is a great way for attackers to gain persistence on the machine. This particular technique falls under <code>T1547</code>(Boot or Logon Autostart Execution), and is listed as a subtechnique with a number of <code>009</code> (Shortcut Modification).</p>
<p><code>T1547.009</code> will be my answer to question 9.</p>
<p><img alt="task9" src="../images/RomCom/task9.png" /></p>
<h1>Task 10</h1>
<p>For the final question, I will move back to the $J output file. I'll search for entries related to the .lnk shortcut of the document.</p>
<p><img alt="create" src="../images/RomCom/create.png" /></p>
<p>The timestamp in this entry is <code>2025-09-02 08:15:05</code>. This will be my answer to the final question.</p>
<p><img alt="task10" src="../images/RomCom/task10.png" /></p>
<p>Solved!</p>
            </div>
            
            <div class="toc-sidebar">
                <h3>Contents</h3>
                <ul id="toc-list">
                    <!-- This will be populated by JavaScript -->
                </ul>
            </div>
        </div>
    </main>
    
    <!-- Mobile TOC toggle button -->
    <button class="toc-toggle" aria-label="Toggle table of contents">
        â‰¡
    </button>
    
    <footer>
        <div class="container">
            <p>&copy; 2025 Hexicon Archives | Created by Hexicon</p>
        </div>
    </footer>

    <!-- Include the Markdown parser (not needed for static HTML) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.3.0/marked.min.js"></script>
    
    <script>
        // Sherlock metadata for sidebar population
        let sherlockData = {};
        
        // Function to initialize the application
        async function initializeApp() {
            try {
                // Fetch sherlock metadata
                const response = await fetch('../sherlocks.json');
                if (!response.ok) {
                    throw new Error('Failed to load sherlock metadata');
                }
                sherlockData = await response.json();
                
                // Populate the sidebar with sherlock links
                populateSidebar();
                
                // Generate table of contents
                generateTableOfContents();
            } catch (error) {
                console.error('Initialization error:', error);
                showError("Failed to initialize application. Please refresh and try again.");
            }
        }

        // Call the initialization function when the page loads
        document.addEventListener('DOMContentLoaded', initializeApp);

        // Populate sidebar with sherlock links dynamically
        function populateSidebar() {
            const categories = {
                "veasy": document.getElementById("veasy-sherlocks"),
                "easy": document.getElementById("easy-sherlocks"),
                "medium": document.getElementById("medium-sherlocks"),
                "hard": document.getElementById("hard-sherlocks"),
                "insane": document.getElementById("insane-sherlocks")
            };

            // Clear existing links
            for (const category of Object.values(categories)) {
                category.innerHTML = '';
            }

            // Add sherlock links to appropriate categories
            for (const [sherlockName, data] of Object.entries(sherlockData)) {
                const difficulty = data.difficulty.toLowerCase();
                if (categories[difficulty]) {
                    const link = document.createElement('a');
                    link.href = `../sherlocks/${sherlockName}.html`;
                    link.textContent = data.title;
                    
                    // Highlight current sherlock
                    if (data.title === "RomCom") {
                        link.classList.add('active');
                    }
                    
                    categories[difficulty].appendChild(link);
                }
            }
        }

        // Generate table of contents from headings
        function generateTableOfContents() {
            const writeupBody = document.querySelector('.writeup-body');
            const tocList = document.getElementById('toc-list');
            const headings = writeupBody.querySelectorAll('h1, h2, h3');
            
            // Clear existing TOC
            tocList.innerHTML = '';
            
            headings.forEach((heading, index) => {
                // Create an ID for the heading if it doesn't have one
                if (!heading.id) {
                    // Convert heading text to kebab-case for ID
                    const headingText = heading.textContent.trim();
                    const headingId = headingText
                        .toLowerCase()
                        .replace(/[^\w\s-]/g, '')
                        .replace(/\s+/g, '-');
                    
                    heading.id = headingId || `section-${index}`;
                }
                
                // Create a list item for the TOC
                const listItem = document.createElement('li');
                const link = document.createElement('a');
                link.href = `#${heading.id}`;
                link.textContent = heading.textContent;
                
                // Add a class for h2 elements to create indentation
                if (heading.tagName === 'H2') {
                    listItem.classList.add('sub-heading');
                    listItem.style.paddingLeft = '15px';
                } else if (heading.tagName === 'H3') {
                    listItem.classList.add('sub-sub-heading');
                    listItem.style.paddingLeft = '30px';
                }
                
                listItem.appendChild(link);
                tocList.appendChild(listItem);
            });
            
            // Set up scroll highlighting
            setupScrollHighlighting();
        }

        // Highlight active TOC section on scroll
        function setupScrollHighlighting() {
            const tocLinks = document.querySelectorAll('.toc-sidebar a');
            
            function highlightActiveSection() {
                // Find which section is currently in view
                const fromTop = window.scrollY + 120;
                
                tocLinks.forEach(link => {
                    const section = document.querySelector(link.hash);
                    
                    if (section && 
                        section.offsetTop <= fromTop &&
                        section.offsetTop + section.offsetHeight > fromTop) {
                        link.classList.add('active');
                    } else {
                        link.classList.remove('active');
                    }
                });
            }
            
            // Call initially and on scroll
            window.addEventListener('scroll', highlightActiveSection);
            highlightActiveSection();
        }

        // Show error message
        function showError(message) {
            const contentArea = document.querySelector('.writeup-body');
            contentArea.innerHTML = `
                <div class="error-message">
                    <h2>Error</h2>
                    <p>${message}</p>
                </div>
            `;
        }

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            // Hamburger menu functionality
            const hamburgerMenu = document.querySelector('.hamburger-menu');
            const sidebar = document.querySelector('.sidebar');
            const backdrop = document.querySelector('.backdrop');
            
            hamburgerMenu.addEventListener('click', () => {
                hamburgerMenu.classList.toggle('active');
                sidebar.classList.toggle('active');
                backdrop.classList.toggle('active');
            });
            
            backdrop.addEventListener('click', () => {
                hamburgerMenu.classList.remove('active');
                sidebar.classList.remove('active');
                backdrop.classList.remove('active');
                tocSidebar.classList.remove('active');
            });
            
            // Difficulty buttons functionality
            const difficultyButtons = document.querySelectorAll('.difficulty-btn');
            
            difficultyButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const difficulty = button.getAttribute('data-difficulty');
                    const sherlockList = document.querySelector(`#${difficulty}-sherlocks`);
                    
                    sherlockList.classList.toggle('active');
                });
            });
            
            // Mobile TOC toggle
            const tocToggle = document.querySelector('.toc-toggle');
            const tocSidebar = document.querySelector('.toc-sidebar');
            
            tocToggle.addEventListener('click', () => {
                tocSidebar.classList.toggle('active');
                backdrop.classList.toggle('active');
            });
            
            // Close TOC sidebar when clicking on a link (mobile)
            document.querySelectorAll('.toc-sidebar a').forEach(link => {
                link.addEventListener('click', () => {
                    if (window.innerWidth <= 1024) {
                        tocSidebar.classList.remove('active');
                        backdrop.classList.remove('active');
                    }
                });
            });
        });

        // Add smooth scrolling for TOC links
        document.addEventListener('click', function(e) {
            if (e.target.tagName === 'A' && e.target.hash) {
                const element = document.querySelector(e.target.hash);
                if (element) {
                    e.preventDefault();
                    window.scrollTo({
                        top: element.offsetTop - 90,
                        behavior: 'smooth'
                    });
                }
            }
        });
    </script>
</body>
</html>