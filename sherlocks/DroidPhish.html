<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow">
    <title>DroidPhish - Hexicon Archives</title>
    <link rel="icon" type="image/x-icon" sizes="500x500" href="../favicon.png">
    <link rel="stylesheet" href="../style.css">
    <link rel="canonical" href="https://hexphased.github.io/hexicon-archives/sherlocks/DroidPhish.html" />
    <!-- Sherlock-specific metadata for SEO -->
    <meta name="description" content="Writeup for DroidPhish sherlock - Easy difficulty level">
    <meta name="keywords" content="Sherlock, DroidPhish, Easy, Blue Team, writeup, cybersecurity, threat hunting, Hexicon">
</head>
<body>
    <header>
        <div class="container header-content">
            <a href="../sherlocks.html" class="logo">Sherlock writeups</a>
            <div class="header-controls">
                <a href="../index.html" class="htb-icon" title="Link to the main page">
                    <img src="../favicon.png" alt="Archive" width="30" height="30">
                </a>
                <div class="hamburger-menu">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
        </div>
    </header>
    
    <div class="sidebar">
        <div class="difficulty-buttons">
            <button class="difficulty-btn" data-difficulty="veasy">VEasy</button>
            <div class="sherlock-list" id="veasy-sherlocks">
                <!-- Will be populated dynamically -->
            </div>

            <button class="difficulty-btn" data-difficulty="easy">Easy</button>
            <div class="sherlock-list" id="easy-sherlocks">
                <!-- Will be populated dynamically -->
            </div>
            
            <button class="difficulty-btn" data-difficulty="medium">Medium</button>
            <div class="sherlock-list" id="medium-sherlocks">
                <!-- Will be populated dynamically -->
            </div>
            
            <button class="difficulty-btn" data-difficulty="hard">Hard</button>
            <div class="sherlock-list" id="hard-sherlocks">
                <!-- Will be populated dynamically -->
            </div>

            <button class="difficulty-btn" data-difficulty="insane">Insane</button>
            <div class="sherlock-list" id="insane-sherlocks">
                <!-- Will be populated dynamically -->
            </div>
        </div>
    </div>
    
    <div class="backdrop"></div>
    
    <main class="container writeup-content">
        <h1 class="writeup-title">DroidPhish</h1>
        <div class="writeup-metadata">
            <span class="difficulty easy">Easy</span>
            <span class="date">September 4, 2025</span>
        </div>
        
        <div class="writeup-container">
            <div class="writeup-body">
                <!-- Sherlock-specific content goes here -->
                <p><img alt="droidphish" src="../images/DroidPhish/solved.png" /></p>
<h1>Task 1</h1>
<p>After unzipping the sherlock archive, I was left with a .dd(disk image) file.</p>
<p><code>DroidPhish.dd: Linux rev 1.0 ext4 filesystem data, UUID=e98cc545-b7fe-4ba9-8b33-2fb9bba476d6, volume name "Android-x86" (needs journal recovery) (extents) (large files)</code></p>
<p>I will mount this filesystem as <code>droidphish</code> under <code>/mnt/droidphish</code></p>
<p><code>sudo mount -o loop DroidPhish.dd /mnt/droidphish</code></p>
<p><img alt="filesystem" src="../images/DroidPhish/filesystem.png" /></p>
<p>Now I can proceed with answering the questions. In android, the <code>bootstat</code> directory contains all sorts of information about the boot process.</p>
<p>For this question, the main point of focus will be the <code>android-9.0-r2/data/misc/bootstat/last_boot_time_utc</code>. As its name suggests, this file will reveal the last time this device was booted up.</p>
<p>However, the file itself is empty. Instead, the value I want to read is the file's last change time, which should be exactly the same as the value it is supposed to contain.</p>
<p><code>sudo stat /mnt/droidphish/android-9.0-r2/data/misc/bootstat/last_boot_time_utc</code></p>
<p><img alt="modify" src="../images/DroidPhish/modify.png" /></p>
<p>This date is 5 hours behind the UTC time, as shown on the right. After adding up the hours, my final answer to question 1 will be <code>2024-11-24 12:05:19</code></p>
<p><img alt="task1" src="../images/DroidPhish/task1.png" /></p>
<h1>Task 2</h1>
<p>In order to look for non-standard apps installed on this device, I navigated to <code>data/app</code></p>
<p><img alt="packages" src="../images/DroidPhish/packages.png" /></p>
<p>I can see the protonmail app in the directory. <code>Proton Mail</code> will be my answer to task 2.</p>
<p><img alt="task2" src="../images/DroidPhish/task2.png" /></p>
<h1>Task 3</h1>
<p>While the <code>data/app</code> directory holds any non-system applications, <code>data/data</code> contains the app's private user data.</p>
<p><img alt="data" src="../images/DroidPhish/data.png" /></p>
<p>Within protonmail's directory, there is a <code>db-mail</code> database. It's recognized as an sqlite3 database, so I'll use sqlite3 to look through the file.</p>
<p><img alt="tables" src="../images/DroidPhish/tables.png" /></p>
<p>I'll read all data contained in the MessageEntity table.</p>
<p><code>select * from MessageEntity;</code></p>
<p>At the bottom, I noticed that there was a suspicious email sent by <code>ceo-ie@sircorp.s1r</code>, containing an attachment.</p>
<p><img alt="email" src="../images/DroidPhish/email.png" /></p>
<p>My answer to question 3 will be <code>Celebrating 3 Years of Success â€“ Thank You!</code></p>
<p><img alt="task3" src="../images/DroidPhish/task3.png" /></p>
<h1>Task 4</h1>
<p>From the same database entry, I took the epoch timestamp and used <code>https://www.epochconverter.com/</code> to convert it.</p>
<p>The final result was n UTC timestamp of <code>2024-11-24 17:04:40</code>. However, this was not the correct answer.</p>
<p>After playing around with the timestamp, I discovered that <code>2024-11-24 17:04:42</code> was the answer instead.</p>
<p><img alt="task4" src="../images/DroidPhish/task4.png" /></p>
<h1>Task 5</h1>
<p>To view the details about downloaded files, I'll navigate to the downloads.db database under <code>data/data/com.android.providers.downloads/databases/downloads.db</code></p>
<p><img alt="entry" src="../images/DroidPhish/entry.png" /></p>
<p><code>https://provincial-consecutive-lbs-boots.trycloudflare.com/Booking.apk</code></p>
<p>The attacker used a cloudflare tunnel to distribute the malicious APK. This link will be my answer to task 5.</p>
<p><img alt="task5" src="../images/DroidPhish/task5.png" /></p>
<h1>Task 6</h1>
<p>In the previous task, I saw that the location to which the file was saved was listed as <code>0/Download/Booking.apk</code>. The full location will be <code>data/media/0/Download/Booking.apk</code></p>
<p><img alt="sha256sum" src="../images/DroidPhish/sha256sum.png" /></p>
<p>My answer to question 6 will be <code>af081cd26474a6071cde7c6d5bd971e61302fb495abcf317b4a7016bdb98eae2</code></p>
<p><img alt="task6" src="../images/DroidPhish/task6.png" /></p>
<h1>Task 7</h1>
<p>With the malware's sha256 hash in my hand, I tested the 2 packages I deemed suspicious to see which one of them was tied to the malware.</p>
<p>By the process of elimination, I narrowed it down to 2 packages, <code>com.hostel.mount</code> and <code>com.termoneplus</code></p>
<p><img alt="compare" src="../images/DroidPhish/compare.png" /></p>
<p>Base.apk inside the <code>com.hostel.mount</code> package has the same sha256sum as the malware, confirming that these 2 are the same files.</p>
<p><code>com.hostel.mount</code> will be my answer to question 7.</p>
<p><img alt="task7" src="../images/DroidPhish/task7.png" /></p>
<h1>Task 8</h1>
<p>In order to read the required timestamps, I will move to <code>android-9.0-r2/data/system/packages.xml</code> since that's the location where all sorts of information about the package is stored.</p>
<p>Since I know the package name, I will use grep to filter the results.</p>
<p><code>sudo cat /mnt/droidphish/android-9.0-r2/data/system/packages.xml | grep hostel</code></p>
<p><img alt="install" src="../images/DroidPhish/install.png" /></p>
<p><code>ft="1935f2ac5f8" it="1935f2b00f3" ut="1935f2b00f3"</code></p>
<p>These 3 values stand for:</p>
<div class="codehilite"><pre><span></span><code>ft=&quot;1909fa201a8&quot; - First install time

it=&quot;1909fa2050b&quot; - Install time

ut=&quot;1909fa2050b&quot; - LastUpdate time
</code></pre></div>

<p>I'll take the value of <code>it</code>.  First, I'll convert it from hex to decimal.</p>
<p><code>1732468474099</code></p>
<p>This reveals an epoch timestamp, which I'll convert using the epoch converter website.</p>
<p><img alt="convert" src="../images/DroidPhish/convert.png" /></p>
<p>After changing the converted timestamp into a UTC format, I was left with <code>2024-11-24 17:14:34</code>. This will be my answer to question 8.</p>
<p><img alt="task8" src="../images/DroidPhish/task8.png" /></p>
<h1>Task 9</h1>
<p>I uploaded the malicious APK to virustotal. This will give me a lot of important information about the malware.</p>
<p>Under the details tab, permissions granted to the malware were displayed.</p>
<p><img alt="permissions" src="../images/DroidPhish/permissions.png" /></p>
<p>Runtime permissions require the user's confirmation. They require the user to press yes on the <code>Allow app to X</code> pop-up.</p>
<p>Virustotal marks these permissions with a red triangle. In total, there are 13 runtime permissions granted to the malware.</p>
<p><img alt="task9" src="../images/DroidPhish/task9.png" /></p>
<h1>Task 10</h1>
<p>Moving to the relations tab, I looked at the list of IP addresses the malware contacted, and I noticed one IP that stands out with a higher detection rate than the others.</p>
<p><img alt="ips" src="../images/DroidPhish/ips.png" /></p>
<p>And in the behavior tab, I saw the same IP address, this time with a port.</p>
<p><img alt="port" src="../images/DroidPhish/port.png" /></p>
<p><code>3.121.139.82:10824</code> will be my answer to question 10.</p>
<p><img alt="task10" src="../images/DroidPhish/task10.png" /></p>
<p>Solved!</p>
            </div>
            
            <div class="toc-sidebar">
                <h3>Contents</h3>
                <ul id="toc-list">
                    <!-- This will be populated by JavaScript -->
                </ul>
            </div>
        </div>
    </main>
    
    <!-- Mobile TOC toggle button -->
    <button class="toc-toggle" aria-label="Toggle table of contents">
        â‰¡
    </button>
    
    <footer>
        <div class="container">
            <p>&copy; 2025 Hexicon Archives | Created by Hexicon</p>
        </div>
    </footer>

    <!-- Include the Markdown parser (not needed for static HTML) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.3.0/marked.min.js"></script>
    
    <script>
        // Sherlock metadata for sidebar population
        let sherlockData = {};
        
        // Function to initialize the application
        async function initializeApp() {
            try {
                // Fetch sherlock metadata
                const response = await fetch('../sherlocks.json');
                if (!response.ok) {
                    throw new Error('Failed to load sherlock metadata');
                }
                sherlockData = await response.json();
                
                // Populate the sidebar with sherlock links
                populateSidebar();
                
                // Generate table of contents
                generateTableOfContents();
            } catch (error) {
                console.error('Initialization error:', error);
                showError("Failed to initialize application. Please refresh and try again.");
            }
        }

        // Call the initialization function when the page loads
        document.addEventListener('DOMContentLoaded', initializeApp);

        // Populate sidebar with sherlock links dynamically
        function populateSidebar() {
            const categories = {
                "veasy": document.getElementById("veasy-sherlocks"),
                "easy": document.getElementById("easy-sherlocks"),
                "medium": document.getElementById("medium-sherlocks"),
                "hard": document.getElementById("hard-sherlocks"),
                "insane": document.getElementById("insane-sherlocks")
            };

            // Clear existing links
            for (const category of Object.values(categories)) {
                category.innerHTML = '';
            }

            // Add sherlock links to appropriate categories
            for (const [sherlockName, data] of Object.entries(sherlockData)) {
                const difficulty = data.difficulty.toLowerCase();
                if (categories[difficulty]) {
                    const link = document.createElement('a');
                    link.href = `../sherlocks/${sherlockName}.html`;
                    link.textContent = data.title;
                    
                    // Highlight current sherlock
                    if (data.title === "DroidPhish") {
                        link.classList.add('active');
                    }
                    
                    categories[difficulty].appendChild(link);
                }
            }
        }

        // Generate table of contents from headings
        function generateTableOfContents() {
            const writeupBody = document.querySelector('.writeup-body');
            const tocList = document.getElementById('toc-list');
            const headings = writeupBody.querySelectorAll('h1, h2, h3');
            
            // Clear existing TOC
            tocList.innerHTML = '';
            
            headings.forEach((heading, index) => {
                // Create an ID for the heading if it doesn't have one
                if (!heading.id) {
                    // Convert heading text to kebab-case for ID
                    const headingText = heading.textContent.trim();
                    const headingId = headingText
                        .toLowerCase()
                        .replace(/[^\w\s-]/g, '')
                        .replace(/\s+/g, '-');
                    
                    heading.id = headingId || `section-${index}`;
                }
                
                // Create a list item for the TOC
                const listItem = document.createElement('li');
                const link = document.createElement('a');
                link.href = `#${heading.id}`;
                link.textContent = heading.textContent;
                
                // Add a class for h2 elements to create indentation
                if (heading.tagName === 'H2') {
                    listItem.classList.add('sub-heading');
                    listItem.style.paddingLeft = '15px';
                } else if (heading.tagName === 'H3') {
                    listItem.classList.add('sub-sub-heading');
                    listItem.style.paddingLeft = '30px';
                }
                
                listItem.appendChild(link);
                tocList.appendChild(listItem);
            });
            
            // Set up scroll highlighting
            setupScrollHighlighting();
        }

        // Highlight active TOC section on scroll
        function setupScrollHighlighting() {
            const tocLinks = document.querySelectorAll('.toc-sidebar a');
            
            function highlightActiveSection() {
                // Find which section is currently in view
                const fromTop = window.scrollY + 120;
                
                tocLinks.forEach(link => {
                    const section = document.querySelector(link.hash);
                    
                    if (section && 
                        section.offsetTop <= fromTop &&
                        section.offsetTop + section.offsetHeight > fromTop) {
                        link.classList.add('active');
                    } else {
                        link.classList.remove('active');
                    }
                });
            }
            
            // Call initially and on scroll
            window.addEventListener('scroll', highlightActiveSection);
            highlightActiveSection();
        }

        // Show error message
        function showError(message) {
            const contentArea = document.querySelector('.writeup-body');
            contentArea.innerHTML = `
                <div class="error-message">
                    <h2>Error</h2>
                    <p>${message}</p>
                </div>
            `;
        }

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            // Hamburger menu functionality
            const hamburgerMenu = document.querySelector('.hamburger-menu');
            const sidebar = document.querySelector('.sidebar');
            const backdrop = document.querySelector('.backdrop');
            
            hamburgerMenu.addEventListener('click', () => {
                hamburgerMenu.classList.toggle('active');
                sidebar.classList.toggle('active');
                backdrop.classList.toggle('active');
            });
            
            backdrop.addEventListener('click', () => {
                hamburgerMenu.classList.remove('active');
                sidebar.classList.remove('active');
                backdrop.classList.remove('active');
                tocSidebar.classList.remove('active');
            });
            
            // Difficulty buttons functionality
            const difficultyButtons = document.querySelectorAll('.difficulty-btn');
            
            difficultyButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const difficulty = button.getAttribute('data-difficulty');
                    const sherlockList = document.querySelector(`#${difficulty}-sherlocks`);
                    
                    sherlockList.classList.toggle('active');
                });
            });
            
            // Mobile TOC toggle
            const tocToggle = document.querySelector('.toc-toggle');
            const tocSidebar = document.querySelector('.toc-sidebar');
            
            tocToggle.addEventListener('click', () => {
                tocSidebar.classList.toggle('active');
                backdrop.classList.toggle('active');
            });
            
            // Close TOC sidebar when clicking on a link (mobile)
            document.querySelectorAll('.toc-sidebar a').forEach(link => {
                link.addEventListener('click', () => {
                    if (window.innerWidth <= 1024) {
                        tocSidebar.classList.remove('active');
                        backdrop.classList.remove('active');
                    }
                });
            });
        });

        // Add smooth scrolling for TOC links
        document.addEventListener('click', function(e) {
            if (e.target.tagName === 'A' && e.target.hash) {
                const element = document.querySelector(e.target.hash);
                if (element) {
                    e.preventDefault();
                    window.scrollTo({
                        top: element.offsetTop - 90,
                        behavior: 'smooth'
                    });
                }
            }
        });
    </script>
</body>
</html>